<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Pepper&#39;s Site</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Pepper&#39;s Site">
<meta property="og:type" content="website">
<meta property="og:title" content="Pepper&#39;s Site">
<meta property="og:url" content="http://thepathfinder.top/page/2/index.html">
<meta property="og:site_name" content="Pepper&#39;s Site">
<meta property="og:description" content="Pepper&#39;s Site">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Pepper Zhang">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Pepper's Site" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Pepper&#39;s Site</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS 订阅"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="搜索"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://thepathfinder.top"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-20231207cross-domain authentication" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023120720231207cross-domain%20authentication/index.html" class="article-date">
  <time class="dt-published" datetime="2023-12-07T02:00:00.000Z" itemprop="datePublished">2023-12-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023120720231207cross-domain%20authentication/index.html">跨域信任关系异常解决</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="跨域信任关系异常解决"><a href="#跨域信任关系异常解决" class="headerlink" title="跨域信任关系异常解决"></a>跨域信任关系异常解决</h1><h2 id="出现问题"><a href="#出现问题" class="headerlink" title="出现问题"></a>出现问题</h2><p>我司近期在做域控账户的迁移，迁移的同时保证对原有的Fileserver访问正常，但是在使用AMDT迁移域账户后新域账户无法访问原来的Fileserver，以下是异常解决过程。</p>
<p>以下涉及到的计算机分别有</p>
<table>
<thead>
<tr>
<th align="center">OLD Domain</th>
<th align="center">New  Domain</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Fileserver</td>
<td align="center">New_DC</td>
</tr>
<tr>
<td align="center">Old_DC</td>
<td align="center">Test_Server</td>
</tr>
</tbody></table>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><h3 id="Step1：DNS-SMB（Server-Message-Block）协议的配置和安全性检查"><a href="#Step1：DNS-SMB（Server-Message-Block）协议的配置和安全性检查" class="headerlink" title="Step1：DNS&amp;SMB（Server Message Block）协议的配置和安全性检查"></a>Step1：DNS&amp;SMB（Server Message Block）协议的配置和安全性检查</h3><p><strong>Test_Sever &amp; Filesever</strong></p>
<p>查询 DNS 信息和获取 SMB 客户端的配置信息</p>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">nslookup</span> <span class="string">severname</span> </span><br><span class="line"><span class="built_in">get-smbclientConfiguration</span> </span><br></pre></td></tr></table></figure>

<img src="/2023120720231207cross-domain%20authentication/index/image-20240124131911277.png" class title="image-20240124131911277">

<h3 id="Step-2：注册表中的特定-GUID-的存在检查"><a href="#Step-2：注册表中的特定-GUID-的存在检查" class="headerlink" title="Step 2：注册表中的特定 GUID 的存在检查"></a>Step 2：注册表中的特定 GUID 的存在检查</h3><p><strong>Test_Server</strong></p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">netstat -aon|<span class="built_in">findstr</span> “<span class="number">445</span>” </span><br><span class="line"></span><br><span class="line">get-netadapter |select Name, IfDesc,InterfaGUID |ft </span><br></pre></td></tr></table></figure>

<img src="/2023120720231207cross-domain%20authentication/index/image-20240124132734453.png" class title="image-20240124132734453">

<p>在注册表编辑器的左侧导航栏中，找到</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\NetCache\Shares</span><br></pre></td></tr></table></figure>

<p>在 <code>Shares</code> 键下，查看是否存在指定的 GUID <code>&#123;XXXXXXXXXXXX&#125;</code>。如果存在，表示该 GUID 在注册表中</p>
<h3 id="Step-3-LAN-Manager-认证级别的检查"><a href="#Step-3-LAN-Manager-认证级别的检查" class="headerlink" title="Step 3:LAN Manager 认证级别的检查"></a>Step 3:LAN Manager 认证级别的检查</h3><p><strong>Filesever;Old_DC;New_DC</strong></p>
<p>检查注册表项 <code>LmCompatibilityLevel</code> 的值,注册表此处均设置LmCompatibilityLevel&#x3D;5 </p>
<p>在注册表编辑器的左侧导航栏中，找到 </p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HKEY_LOCAL_MACHINE\SYSTEM\CurrenControlSet\Control\Lsa</span><br></pre></td></tr></table></figure>

<img src="/2023120720231207cross-domain%20authentication/index/image-20240124133836722.png" class title="image-20240124133836722">



<h3 id="Step-4-网络抓包"><a href="#Step-4-网络抓包" class="headerlink" title="Step 4 网络抓包"></a>Step 4 网络抓包</h3><p>抓包工具抓取Test_Server在访问FileServer时候的网络情况 </p>
<img src="/2023120720231207cross-domain%20authentication/index/image-20240124135729454.png" class title="image-20240124135729454">

<p>到FileServer访问时 ，提交了 ntlmssp 身份验证请求后，服务器直接status-not-support断开了 </p>
<p>访问 Old_DC时，提交了 ntlmssp 身份验证后，Old_DC继续让提交凭据 </p>
<img src="/2023120720231207cross-domain%20authentication/index/image-20240124135851338.png" class title="image-20240124135851338">

<p>问题应该不在客户端，在FileServer那台服务器的身份验证上 </p>
<p>成功和失败的访问协商的都是使用 smb3.1 </p>
<style>.rwiywhaphqqw{zoom: 80%;}</style><img src="/2023120720231207cross-domain%20authentication/index/image-20240124135927395.png" class="rwiywhaphqqw" alt="image-20240124135927395">

<p>FileServer这台机器不接受跨域的这种访问</p>
<img src="/2023120720231207cross-domain%20authentication/index/image-20240124140012463.png" class title="image-20240124140012463">

<p>无论成功还是失败的网络报，协商时，第一次提交的ntlm认证信息都是null </p>
<p>FileServer不接受这种null </p>
<p>FileServer组策略设置 重启后生效 </p>
<img src="/2023120720231207cross-domain%20authentication/index/image-20240124135117184.png" class title="image-20240124135117184">

<h3 id="Step-5-策略更改"><a href="#Step-5-策略更改" class="headerlink" title="Step 5 策略更改"></a>Step 5 策略更改</h3><p><strong>注意：此处设定可能与早期不让用户通过IP访问FileServer有关</strong> </p>
<img src="/2023120720231207cross-domain%20authentication/index/image-20240124135301409.png" class title="image-20240124135301409">

<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Rsop.msc </span><br><span class="line">Groupdate/force  //刷新策略</span><br></pre></td></tr></table></figure>

<img src="/2023120720231207cross-domain%20authentication/index/image-20240124135410695.png" class title="image-20240124135410695">

<p>问题解决，确实是因为早期策略设置隐藏IP访问共享文件夹。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://thepathfinder.top/2023120720231207cross-domain%20authentication/index.html" data-id="cm4tuip2g001mmcet40ksalra" data-title="跨域信任关系异常解决" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Profwiz/" rel="tag">Profwiz</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%9F%9F%E8%B4%A6%E6%88%B7%E8%BF%81%E7%A7%BB/" rel="tag">域账户迁移</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%B7%A8%E5%9F%9F%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/" rel="tag">跨域信任关系</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-20231123OutlookadminPassword" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/20231123OutlookadminPassword/index.html" class="article-date">
  <time class="dt-published" datetime="2023-11-23T02:00:00.000Z" itemprop="datePublished">2023-11-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/O365/">O365</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/20231123OutlookadminPassword/index.html">Outlook用户无法通过忘记密码流程自助重置密码</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Outlook用户无法通过忘记密码流程自助重置密码"><a href="#Outlook用户无法通过忘记密码流程自助重置密码" class="headerlink" title="Outlook用户无法通过忘记密码流程自助重置密码"></a>Outlook用户无法通过忘记密码流程自助重置密码</h1><h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><p>我们启用新域名邮箱后，APP中用户无法通过忘记密码流程自主重置密码，相关管理员会收到邮件提醒。</p>
<img src="/20231123OutlookadminPassword/index/image-20241203154147537.png" class title="image-20241203154147537">

<img src="/20231123OutlookadminPassword/index/image-20241203154241919.png" class title="image-20241203154241919">



<h2 id="解决方案概述"><a href="#解决方案概述" class="headerlink" title="解决方案概述"></a>解决方案概述</h2><p>如果管理员收到了用户重置密码的邮件提醒，通常是因为 <strong>手机号未验证</strong> 或 <strong>用户的安全信息配置不完整</strong>，导致系统无法自动完成密码重置。</p>
<p><strong>启用自助密码重置（SSPR）</strong> 和确保 <strong>用户安全信息完整</strong> 是解决该问题的关键。</p>
<h2 id="具体操作步骤"><a href="#具体操作步骤" class="headerlink" title="具体操作步骤"></a>具体操作步骤</h2><h3 id="Step-1-设置自助密码重置服务（SSPR）"><a href="#Step-1-设置自助密码重置服务（SSPR）" class="headerlink" title="Step 1 设置自助密码重置服务（SSPR）"></a><strong>Step 1 设置自助密码重置服务（SSPR）</strong></h3><p>以管理员身份登录 <strong>Admin Center</strong>：<a target="_blank" rel="noopener" href="https://portal.office.com/Adminportal/Home/#/homepage">https://portal.office.com/Adminportal/Home/#/homepage</a></p>
<ol>
<li>登录后，点击左侧全部显示，选择<strong>标识</strong>，进入 <strong>Mircrosoft Entra管理中心</strong>。</li>
<li>在 <strong>保护（Security） &gt; 密码重置（Authentication Methods）</strong> 下，启用自助服务密码重置 **Self-Service Password Reset (SSPR)**。</li>
<li><strong>该设置仅对用户生效，管理员任然采取双重身份验证方式来重置密码。</strong></li>
</ol>
<img src="/20231123OutlookadminPassword/index/image-20241203172427988.png" class title="image-20241203172427988">

<h3 id="Step-2-设置身份验证方法"><a href="#Step-2-设置身份验证方法" class="headerlink" title="Step 2 设置身份验证方法"></a>Step 2 设置身份验证方法</h3><p>配置适当的 <strong>验证方式</strong>（如手机号、备用邮箱），确保用户可以通过这些方式验证身份来重置密码。</p>
<ol>
<li>登录后，点击左侧全部显示，选择<strong>标识</strong>，进入 <strong>Mircrosoft Entra管理中心</strong>。</li>
<li>在 <strong>保护（Security） &gt; 密码重置（Authentication Methods）</strong> 下，选择身份验证方法。 密码重置身份验证方法仅保留一个，该设置会在24小时后生效。</li>
<li><strong>该设置仅对用户生效，管理员任然采取双重身份验证方式来重置密码。</strong></li>
</ol>
<img src="/20231123OutlookadminPassword/index/image-20241203171924908.png" class title="image-20241203171924908">

<h3 id="Step-3-用户忘记密码-需要设置验证方式"><a href="#Step-3-用户忘记密码-需要设置验证方式" class="headerlink" title="Step 3 用户忘记密码-需要设置验证方式"></a><strong>Step 3 用户忘记密码-需要设置验证方式</strong></h3><p>如果用户账户事先已经在 <strong>Entra</strong> 中配置了手机号，没有首次验证就修改密码。</p>
<p>&gt; <strong>Note:</strong> 该情况在用户中基本不会出现，新用户入职的时候管理员会设置相关入职信息（手机号）</p>
<ol>
<li><p>用户登录 <strong>Office.com</strong> 或 <strong>Entra</strong>。</p>
<img src="/20231123OutlookadminPassword/index/image-20241203214327266.png" class title="image-20241203214327266">
</li>
<li><p>在 <strong>安全信息</strong> 中，用户需要添加并验证 <strong>手机号</strong> 或 <strong>备用邮箱</strong>。<strong>验证手机号</strong>：用户可以选择短信验证来接收验证码进行身份验证。</p>
<img src="/20231123OutlookadminPassword/index/image-20241203214401795.png" class title="image-20241203214401795">

<img src="/20231123OutlookadminPassword/index/image-20241203214431532.png" class title="image-20241203214431532">

<img src="/20231123OutlookadminPassword/index/image-20241203214504357.png" class title="image-20241203214504357">
</li>
<li><p>确保手机号已验证后，用户在忘记密码时即可使用手机号进行身份验证，完成密码重置。</p>
<img src="/20231123OutlookadminPassword/index/image-20241203214530045.png" class title="image-20241203214530045"></li>
</ol>
<h3 id="Step-4-用户通过-APP-Web自助重置密码"><a href="#Step-4-用户通过-APP-Web自助重置密码" class="headerlink" title="Step 4  用户通过 APP &#x2F;Web自助重置密码"></a><strong>Step 4  用户通过 APP &#x2F;Web自助重置密码</strong></h3><ol>
<li><p>用户打开 <strong>APP</strong>，输入账户进行登录。</p>
<img src="/20231123OutlookadminPassword/index/image-20241203214620603.png" class title="image-20241203214620603">

<img src="/20231123OutlookadminPassword/index/image-20241203214651704.png" class title="image-20241203214651704"></li>
</ol>
<p>&gt; <strong>Note:</strong> 图示为管理员账户，进行了双重身份验证。</p>
<ol start="2">
<li><p>用户将收到验证码，验证通过后即可重置密码。</p>
<img src="/20231123OutlookadminPassword/index/image-20241203214809909.png" class title="image-20241203214809909"></li>
</ol>
<h2 id="导致问题产生的其他原因及解决方法"><a href="#导致问题产生的其他原因及解决方法" class="headerlink" title="导致问题产生的其他原因及解决方法"></a>导致问题产生的其他原因及解决方法</h2><p><strong>用户未完成手机号验证</strong></p>
<ul>
<li>如果用户在 <strong>Entra</strong> 中设置了手机号，但 <strong>没有完成手机号的验证</strong>，系统会认为手机号未有效绑定为安全验证方式。这时，用户在尝试重置密码时，<strong>系统无法使用手机号</strong> 进行身份验证，而是会将请求转发给管理员，要求管理员干预。</li>
<li><strong>解决办法</strong>：管理员可以检查用户是否已经验证过手机号，并要求用户完成验证过程。通常，用户会收到验证短信或邮件来完成手机号验证。</li>
</ul>
<p><strong>用户的安全设置不符合自动重置条件</strong></p>
<ul>
<li>如果用户的安全设置不符合自动重置密码的要求（例如，<strong>没有设置足够的验证方式</strong>，如备用邮箱、手机等），系统依然可能无法让用户自动完成密码重置。</li>
<li><strong>解决办法</strong>：管理员可以通过 Azure AD <strong>检查用户的安全设置</strong>，确保已设置 <strong>双因子认证（2FA）</strong> 或 <strong>其他身份验证方式</strong>，并确保这些验证方式已正确配置。</li>
</ul>
<p><strong>未启用自助密码重置（SSPR）</strong></p>
<ul>
<li><p>如果 <strong>自助密码重置（SSPR）</strong> 没有在 <strong>Azure AD</strong> 中启用，用户在尝试重置密码时无法自行完成，系统会默认通知管理员介入。</p>
</li>
<li><p><strong>解决办法</strong>：详见本文</p>
</li>
</ul>
<p><strong>双因子认证（2FA）或多因素认证（MFA）相关问题</strong></p>
<ul>
<li>如果 <strong>双因子认证（2FA）</strong> 已启用，用户需要同时完成 <strong>两种验证</strong>（例如：手机号 + 备用邮箱）。如果其中一种验证方式未配置，系统会认为用户的认证信息不完整，导致管理员收到邮件。</li>
<li><strong>解决办法</strong>：管理员可以检查用户是否已启用并配置了双因子认证（2FA），确保用户的 <strong>手机号和备用邮箱</strong> 都已配置并验证。</li>
<li>详见微软官方解释：<a target="_blank" rel="noopener" href="https://www.microsoft.com/zh-cn/security/business/security-101/what-is-two-factor-authentication-2fa">什么是双因素身份验证 (2FA)？ | Microsoft 安全</a></li>
</ul>
<p><strong>管理员邮箱通知设置</strong></p>
<ul>
<li>如果用户的密码重置请求被视为异常情况或违反了某些安全策略（如连续多次失败的密码重置尝试），系统会触发一个管理员警告或通知邮件，提示管理员干预。</li>
<li><strong>解决办法</strong>：管理员可以检查 <strong>Azure AD 的通知设置</strong>，看看是否已启用管理员通知，或者是否有特定的安全策略触发了管理员通知。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://thepathfinder.top/20231123OutlookadminPassword/index.html" data-id="cm4tuip25000cmcetalen8mgn" data-title="Outlook用户无法通过忘记密码流程自助重置密码" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Outlook/" rel="tag">Outlook</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-20231122OutlookmeetingPermission" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/20231122OutlookmeetingPermission/index.html" class="article-date">
  <time class="dt-published" datetime="2023-11-22T02:00:00.000Z" itemprop="datePublished">2023-11-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/O365/">O365</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/20231122OutlookmeetingPermission/index.html">Outlook日历查看会议室不显示具体信息</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Outlook日历查看会议室不显示具体信息"><a href="#Outlook日历查看会议室不显示具体信息" class="headerlink" title="Outlook日历查看会议室不显示具体信息"></a>Outlook日历查看会议室不显示具体信息</h1><h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><p>我们启用新域名邮箱后，添加会议室共享日历发现无法查看其他会议室的预定情况</p>
<img src="/20231122OutlookmeetingPermission/index/Snipaste_2024-12-02_15-35-02.jpg" class title="Snipaste_2024-12-02_15-35-02">

<p>新建会议中《显示为》默认为“忙”</p>
<img src="/20231122OutlookmeetingPermission/index/image-20241202153624197.png" class title="image-20241202153624197">



<h2 id="解决方案概述"><a href="#解决方案概述" class="headerlink" title="解决方案概述"></a>解决方案概述</h2><p>通过 PowerShell 设置会议室日历的权限为“开放”状态，让所有用户都能够查看会议室的详细信息（包括会议时间、与会人员等），避免每次人员变动时都需要手动调整权限。</p>
<p>权限控制有两个方向，控制用户对每个会议室共享日历的权限，能做到更精细的控制，但是实际业务中不太可能采用这种方式，新入职用户难道要每次设置权限吗？如果需要这部分内容，详尽本文第6部分，相关Powershell命令</p>
<p>所以大部分是控制会议室共享日历的权限，默认会议室共享日历是对所有用户开放的，即所有人添加了日历在Outlook中就可以看到会议室占用的详情。</p>
<h2 id="具体操作步骤"><a href="#具体操作步骤" class="headerlink" title="具体操作步骤"></a>具体操作步骤</h2><h3 id="1-PowerShell-配置"><a href="#1-PowerShell-配置" class="headerlink" title="1. PowerShell 配置"></a>1. <strong>PowerShell 配置</strong></h3><p>为了执行这些命令，你需要配置 PowerShell 环境并确保能连接到 Exchange Online。</p>
<h4 id="1-安装必要模块"><a href="#1-安装必要模块" class="headerlink" title="(1) 安装必要模块"></a>(1) <strong>安装必要模块</strong></h4><p>首先，安装 <code>ExchangeOnlineManagement</code> 模块：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Install-Module</span> <span class="literal">-Name</span> ExchangeOnlineManagement</span><br></pre></td></tr></table></figure>

<p>如果遇到如图所示问题，提示没有NuGet存储库</p>
<img src="/20231122OutlookmeetingPermission/index/Snipaste_2024-12-03_10-08-26.jpg" class title="Snipaste_2024-12-03_10-08-26">

<p>可以执行以下命令来修复：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">System.Net.ServicePointManager</span>]::SecurityProtocol = [<span class="type">System.Net.SecurityProtocolType</span>]:Tls12;</span><br></pre></td></tr></table></figure>

<p>上述命令执行后再次安装 <code>ExchangeOnlineManagement</code> 模块</p>


<h4 id="2-允许执行脚本"><a href="#2-允许执行脚本" class="headerlink" title="(2) 允许执行脚本"></a>(2) <strong>允许执行脚本</strong></h4><p>如果 PowerShell 提示无法执行脚本</p>
<img src="/20231122OutlookmeetingPermission/index/image-20241203110159388.png" class title="image-20241203110159388">

<p>请运行以下命令允许脚本执行：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set-ExecutionPolicy</span> RemoteSigned</span><br></pre></td></tr></table></figure>

<img src="/20231122OutlookmeetingPermission/index/image-20241203110215316.png" class title="image-20241203110215316">然后选择“全部”确认。

<h4 id="3-连接到-Exchange-Online"><a href="#3-连接到-Exchange-Online" class="headerlink" title="(3) 连接到 Exchange Online"></a>(3) <strong>连接到 Exchange Online</strong></h4><p>使用以下命令连接到 Exchange Online：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Connect-ExchangeOnline</span></span><br></pre></td></tr></table></figure>

<img src="/20231122OutlookmeetingPermission/index/image-20241203110241798.png" class title="image-20241203110241798">

<img src="/20231122OutlookmeetingPermission/index/image-20241203110253728.png" class title="image-20241203110253728">

<h3 id="2-获取权限的名单处理"><a href="#2-获取权限的名单处理" class="headerlink" title="2.获取权限的名单处理"></a>2.获取权限的名单处理</h3><p>Exchange管理员中心导出所有人邮箱信息为CSV，后面将导出的文件称之为user.csv</p>
<img src="/20231122OutlookmeetingPermission/index/image-20241203130416451.png" class title="image-20241203130416451">

<p>编辑csv文件,除了邮箱地址其他的列全部删除，确保保留的是Mailbox</p>
<img src="/20231122OutlookmeetingPermission/index/image-20241203130433525.png" class title="image-20241203130433525">

<h3 id="3-获取会议室列表"><a href="#3-获取会议室列表" class="headerlink" title="3.获取会议室列表"></a>3.获取会议室列表</h3><p>另存为只有会议室Name的csv文件，后面将导出的文件称之为room.csv</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-Mailbox</span> <span class="literal">-RecipientTypeDetails</span> RoomMailbox</span><br></pre></td></tr></table></figure>

<img src="/20231122OutlookmeetingPermission/index/image-20241203140715218.png" class title="image-20241203140715218">

<h3 id="4-删除不必要的权限"><a href="#4-删除不必要的权限" class="headerlink" title="4. 删除不必要的权限"></a>4. <strong>删除不必要的权限</strong></h3><p>如果之前已经为某个用户设置了不必要的权限，或者进行了误操作，可以通过以下命令将其删除：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">remove-MailboxFolderPermission</span> <span class="literal">-Identity</span> <span class="string">&quot;会议室邮箱地址:\calendar&quot;</span> <span class="literal">-User</span> <span class="string">&quot;用户邮箱地址&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>作用</strong>：该命令将删除指定用户对指定会议室日历的访问权限。</li>
</ul>
<p>删除某个会议室批量用户权限</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Import-Csv</span> C:\user.csv | <span class="keyword">foreach</span> &#123;<span class="built_in">Remove-MailboxFolderPermission</span> <span class="literal">-Identity</span> <span class="string">&quot;会议室邮箱地址:\Calendar&quot;</span> <span class="literal">-User</span> <span class="variable">$_</span>.Mailbox <span class="literal">-Confirm</span>:<span class="variable">$false</span>&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>作用</strong>：该命令将删除批量用户对会议室日历的访问权限。</li>
</ul>
<p>删除所有会议室所有用户权限</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Import-Csv</span> C:\room.csv | <span class="built_in">ForEach-Object</span> &#123; <span class="built_in">Import-Csv</span> C:\user.csv | <span class="built_in">ForEach-Object</span> &#123; <span class="built_in">Remove-MailboxFolderPermission</span> <span class="literal">-Identity</span> <span class="string">&quot;<span class="variable">$</span>(<span class="variable">$_</span>.RoomEmail):\Calendar&quot;</span> <span class="literal">-User</span> <span class="variable">$_</span>.Mailbox <span class="literal">-Confirm</span>:<span class="variable">$false</span> &#125; &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>作用</strong>：该命令将删除批量用户对所有会议室日历的访问权限。</li>
</ul>
<h3 id="5-开启会议室权限"><a href="#5-开启会议室权限" class="headerlink" title="5.开启会议室权限"></a>5.开启会议室权限</h3><p>开启会议室权限,对所有的会议室开启一次即可</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Add-MailboxFolderPermission</span> <span class="literal">-Identity</span> <span class="string">&quot;会议室邮箱地址:\Calendar&quot;</span> <span class="literal">-User</span> Default <span class="literal">-AccessRights</span> Reviewer </span><br></pre></td></tr></table></figure>

<ul>
<li><strong>作用</strong>：开启一个会议室</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Import-Csv</span> C:\rooms.csv | <span class="keyword">foreach</span> &#123;<span class="built_in">Add-MailboxFolderPermission</span> <span class="literal">-Identity</span> <span class="string">&quot;<span class="variable">$</span>(<span class="variable">$_</span>.RoomName):\Calendar&quot;</span> <span class="literal">-User</span> Default <span class="literal">-AccessRights</span> Reviewer&#125; </span><br></pre></td></tr></table></figure>

<ul>
<li><strong>作用</strong>：开启所有的会议室</li>
</ul>
<p>相当于如图所示开启共享日历的权限，将日历中的权限开启为，可查看全部详细信息（会议室，时间，会议召开人员）</p>
<img src="/20231122OutlookmeetingPermission/index/image-20241203141419141.png" class title="image-20241203141419141">

<h3 id="6-相关Powershell命令"><a href="#6-相关Powershell命令" class="headerlink" title="6.相关Powershell命令"></a>6.相关Powershell命令</h3><h4 id="6-1-删除"><a href="#6-1-删除" class="headerlink" title="6.1.删除"></a>6.1.删除</h4><p>为某个会议室删除某个用户的权限</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">remove-MailboxFolderPermission</span> <span class="literal">-Identity</span>  会议室邮箱地址:\calendar <span class="literal">-User</span> xxx@xxx</span><br></pre></td></tr></table></figure>

<h4 id="6-2-添加"><a href="#6-2-添加" class="headerlink" title="6.2.添加"></a>6.2.添加</h4><p>为某个会议室增加某个用户的权限</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Add-MailboxFolderPermission</span> <span class="literal">-Identity</span> 会议室邮箱地址::\calendar <span class="literal">-User</span> xxx@xxx <span class="literal">-AccessRights</span> LimitedDetails </span><br></pre></td></tr></table></figure>

<h4 id="6-3-查看powershell"><a href="#6-3-查看powershell" class="headerlink" title="6.3.查看powershell"></a>6.3.查看powershell</h4><p>查看某个会议室中所有有权限的用户</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">get-MailboxFolderPermission</span> <span class="literal">-Identity</span> xxx@xxx:\calendar |<span class="built_in">fl</span> user（查看具体的用户名）</span><br></pre></td></tr></table></figure>

<h4 id="6-4-添加"><a href="#6-4-添加" class="headerlink" title="6.4.添加"></a>6.4.添加</h4><p>通过csv批量添加用户</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Import-Csv</span> C:\user.csv | <span class="keyword">foreach</span> &#123;<span class="built_in">add-MailboxFolderPermission</span> <span class="literal">-Identity</span> 会议室邮箱地址:\calendar <span class="literal">-user</span> <span class="variable">$_</span>.Mailbox <span class="literal">-AccessRights</span> LimitedDetails &#125; </span><br></pre></td></tr></table></figure>

<h4 id="6-5-增加新用户"><a href="#6-5-增加新用户" class="headerlink" title="6.5.增加新用户"></a>6.5.增加新用户</h4><h5 id="6-5-1-添加"><a href="#6-5-1-添加" class="headerlink" title="6.5.1.添加"></a>6.5.1.添加</h5><p>为xxx@xxx设置所有会议室的权限</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Import-Csv</span> C:\room.csv | <span class="keyword">foreach</span> &#123;<span class="built_in">Add-MailboxFolderPermission</span> <span class="literal">-Identity</span> <span class="variable">$_</span>.User <span class="literal">-user</span> xxx@xxx</span><br><span class="line"></span><br><span class="line"> <span class="literal">-AccessRights</span> LimitedDetails &#125;</span><br></pre></td></tr></table></figure>

<h5 id="6-5-2删除"><a href="#6-5-2删除" class="headerlink" title="6.5.2删除"></a>6.5.2删除</h5><p>为xxx@xxx移除所有会议室的权限</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Import-Csv</span> C:\room.csv | <span class="keyword">foreach</span> &#123;<span class="built_in">remove-MailboxFolderPermission</span> <span class="literal">-Identity</span> <span class="variable">$_</span>.User <span class="literal">-user</span> xxx@xxx  <span class="literal">-Confirm</span>:<span class="variable">$false</span>&#125;</span><br></pre></td></tr></table></figure>

<p> -Confirm:$false可删除，删除之后对每个会议室中删除都需要进行确认</p>
<h2 id="总结与优势"><a href="#总结与优势" class="headerlink" title="总结与优势"></a><strong>总结与优势</strong></h2><p>通过将会议室的日历权限设置为“开放”状态，你可以轻松地让所有需要查看会议室日历的用户访问，而无需在人员变动时每次都调整权限。这样的方法更加高效，避免了权限管理的复杂性。</p>
<ul>
<li><strong>简化权限管理</strong>：不需要在人员变动时频繁修改权限。</li>
<li><strong>高效查看信息</strong>：所有有权限的用户都可以查看会议室的日历和详细信息。</li>
<li><strong>批量操作</strong>：可以通过 CSV 文件批量设置权限，节省时间和精力。</li>
</ul>
<p>这种方式特别适用于团队较大或经常变动的环境，可以大大简化权限管理工作。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://thepathfinder.top/20231122OutlookmeetingPermission/index.html" data-id="cm4tuip200001mcet7dxm44zo" data-title="Outlook日历查看会议室不显示具体信息" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Outlook/" rel="tag">Outlook</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/O365/">O365</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Copilot/" rel="tag">Copilot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Edge/" rel="tag">Edge</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Onedrive/" rel="tag">Onedrive</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Outlook/" rel="tag">Outlook</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Powershell/" rel="tag">Powershell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Profwiz/" rel="tag">Profwiz</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sharepoint/" rel="tag">Sharepoint</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Teams/" rel="tag">Teams</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Win-Apps/" rel="tag">Win Apps</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%96%E7%BA%AA%E4%BA%92%E8%81%94/" rel="tag">世纪互联</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9F%9F%E8%B4%A6%E6%88%B7%E8%BF%81%E7%A7%BB/" rel="tag">域账户迁移</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%A8%E5%8F%8BU8/" rel="tag">用友U8</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%87%AA%E5%8A%A8%E8%84%9A%E6%9C%AC/" rel="tag">自动脚本</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B7%A8%E5%9F%9F%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/" rel="tag">跨域信任关系</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Copilot/" style="font-size: 10px;">Copilot</a> <a href="/tags/Edge/" style="font-size: 10px;">Edge</a> <a href="/tags/Onedrive/" style="font-size: 10px;">Onedrive</a> <a href="/tags/Outlook/" style="font-size: 15px;">Outlook</a> <a href="/tags/Powershell/" style="font-size: 12.5px;">Powershell</a> <a href="/tags/Profwiz/" style="font-size: 17.5px;">Profwiz</a> <a href="/tags/Sharepoint/" style="font-size: 12.5px;">Sharepoint</a> <a href="/tags/Teams/" style="font-size: 10px;">Teams</a> <a href="/tags/Win-Apps/" style="font-size: 12.5px;">Win Apps</a> <a href="/tags/%E4%B8%96%E7%BA%AA%E4%BA%92%E8%81%94/" style="font-size: 10px;">世纪互联</a> <a href="/tags/%E5%9F%9F%E8%B4%A6%E6%88%B7%E8%BF%81%E7%A7%BB/" style="font-size: 20px;">域账户迁移</a> <a href="/tags/%E7%94%A8%E5%8F%8BU8/" style="font-size: 10px;">用友U8</a> <a href="/tags/%E8%87%AA%E5%8A%A8%E8%84%9A%E6%9C%AC/" style="font-size: 10px;">自动脚本</a> <a href="/tags/%E8%B7%A8%E5%9F%9F%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB/" style="font-size: 10px;">跨域信任关系</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">十二月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">八月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">七月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">五月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">二月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">一月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">十二月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">十一月 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/20241218test/index.html">测试文档</a>
          </li>
        
          <li>
            <a href="/20240806O365appstoextra/index.html">Sharepoint实现对组织外部共享</a>
          </li>
        
          <li>
            <a href="/20240723-21Csharepoint/index.html">世纪互联sharepoint文件批量下载</a>
          </li>
        
          <li>
            <a href="/20240508OutlookcalenderPermission/index.html">Outlook管理员授权设置用户日历共享</a>
          </li>
        
          <li>
            <a href="/20240201Profwiz-3/index.html">Profwiz迁域可能导致的问题-解决方案（三）</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 Pepper Zhang<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>